## HDF5 Fortran Parallel Library Test Makefile(.in)
##
## Copyright (C) 2000 National Center for Supercomputing Applications
##                    All rights reserved
##
##
top_srcdir=@top_srcdir@/..
top_builddir=../..
srcdir=@srcdir@
@COMMENCE@

hdf5_builddir=$(top_builddir)/src

## Add the include directory to the C preprocessor flags the the hdf5 library
## to the library list.
LT_LINK_LIB=$(LT) --mode=link $(F9X) -static -rpath $(libdir)
LIBFORTRAN=../src/libhdf5_fortran.la
LIBHDF5=$(hdf5_builddir)/libhdf5.la

## These tests are parallel
RUNTEST=$(RUNPARALLEL)

## These are our main targets
TEST_PROGS=ptesthdf5_fortran

## Temporary files
MOSTLYCLEAN=ParaEg[123].h5f
DISTCLEAN=go

## Test source files
TEST_PFORTRAN_SRC=ptesthdf5_fortran.f90 thdf5.f90 tcheck.f90 thyperslab_wr.f90
TEST_PFORTRAN_OBJ=$(TEST_PFORTRAN_SRC:.f90=.lo)
TEST_SRC=$(TEST_PFORTRAN_SRC)
TEST_OBJ=$(TEST_SRC:.f90=.lo)
TEST_HDR=

## How to build the tests... They all depend on the hdf5 library
$(TEST_PROGS): $(LIBHDF5) $(LIBH5TEST)

$(TEST_OBJ): $(TEST_HDR)

## Put in dependencies to the THDF5 module so that things will be built
## in the correct order.
thyperslab_wr.lo:	    $(srcdir)/thyperslab_wr.f90 thdf5.lo
ptesthdf5_fortran.lo:	    $(srcdir)/ptesthdf5_fortran.f90 thdf5.lo

ptesthdf5_fortran: thdf5.lo thyperslab_wr.lo tcheck.lo ptesthdf5_fortran.lo
	@$(LT_LINK_FEXE) $(FFLAGS) -o $@ ptesthdf5_fortran.lo thdf5.lo thyperslab_wr.lo tcheck.lo $(LIBFORTRAN) $(LIBHDF5) $(LIBS)

@CONCLUDE@
