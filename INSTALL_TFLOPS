
FOR THE INTEL TFLOPS MACHINE:

Below are the step-by-step procedures for building, testing, and
installing both the sequential and parallel versions of the HDF5 library.

---------------
Sequential HDF5:
---------------

The setup process for building the sequential HDF5 library for the
ASCI Red machine is done by a coordination of events from sasn100 and
janus.  Though janus can do compiling, it is better to build it
from sasn100 which has more complete building tools and runs faster.
It is also anti-social to tie up janus with compiling.  The HDF5 building
requires the use of janus because one of steps is to execute a program
to find out the run-time characteristics of the TFLOPS machine.

Assuming you have already unpacked the HDF5 tar-file into the 
directory <hdf5>, follow the steps below:

FROM SASN100,

1) cd <hdf5>

2) ./configure tflop
2.1) Due to a bug, you must first edit the files, src/Makefile and
     test/Makefile with the following shell commands before doing make.

# Patch up various Makefile's.
# patch up src/Makefile
ed - src/Makefile <<'EOF'
/^LT_RUN=.*/s//LT_RUN=$(RUNTEST)/
w
q
EOF
# patch up test/Makefile
ed - test/Makefile <<'EOF'
/^RUNTEST=$(LT_RUN)/s/^/#/
w
q
EOF


3) make H5detect


FROM JANUS, 

4) cd <hdf5>

5) make H5Tinit.c


FROM SASN100,

6) make


When everything is finished compiling and linking,
you can run the tests by
FROM JANUS, 

7) make check 
   Note: Sometimes the "make check" fails in the sub-directories of test
   or tools with a message as "print not found".  This is due to the
   "make" of Janus thinking some binary code needs to be recompiled.
   I suspect it may be due to file timestamp problems between SASN100
   and JANUS.  The easiest way to fix it is

   FROM SASN100
   cd <hdf5>/test	# or cd <hdf5>/tools
   make clean; make   # re-make all binary


Once satisfied with the test results, you can install
the software by
FROM SASN100,

8) make install


---------------
Parallel HDF5:
---------------

The setup process for building the parallel version of the HDF5 library for the
ASCI Red machine is very similar to the sequential version.  Since TFLOPS
does not support MPIO, we have prepared a shell-script file that configures
with the appropriate MPI library.

Assuming you have already unpacked the HDF5 tar-file into the 
directory <hdf5>, follow the steps below:
FROM SASN100,

1) cd <hdf5>

2) CC=/usr/community/mpich/mpich-1.1.2/bin/mpicc ./configure --enable-parallel 
   /* If you want to use your own MPI and/or MPIO libraries, */
   /* you may check the file bin/config_para_tflops.sh for details. */
2.1) Due to a bug, you must first edit the files, src/Makefile and
     test/Makefile with the following shell commands before doing make.

# Patch up various Makefile's.
# patch up src/Makefile
ed - src/Makefile <<'EOF'
/^LT_RUN=.*/s//LT_RUN=$(RUNTEST)/
w
q
EOF
# patch up test/Makefile
ed - test/Makefile <<'EOF'
/^RUNTEST=$(LT_RUN)/s/^/#/
w
q
EOF


3) make H5detect


FROM JANUS, 

4) cd <hdf5>

5) make H5Tinit.c


FROM SASN100,

6) make


When everything is finished compiling and linking,
FROM JANUS, 

7) make check 
   Note: Sometimes the "make check" fails in the sub-directories of test
   or tools with a message as "print not found".  This is due to the
   "make" of Janus thinking some binary code needs to be recompiled.
   I suspect it may be due to file timestamp problems between SASN100
   and JANUS.  The easiest way to fix it is

   FROM SASN100
   cd <hdf5>/test	# or cd <hdf5>/tools
   make clean; make   # re-make all binary


Once satisfied with the parallel test results, as long as you 
have the correct permission,
FROM SASN100,

8) make install


