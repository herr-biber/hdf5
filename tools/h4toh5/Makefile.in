## HDF5 Library Makefile(.in)
##
## Copyright (C) 2001 National Center for Supercomputing Applications.
##                    All rights reserved.
##
## 
top_srcdir=@top_srcdir@
top_builddir=../..
srcdir=@srcdir@
SUBDIRS=
@COMMENCE@

## Add include directory to the C preprocessor flags, add -lh5tools and
## -lhdf5 to the list of libraries.
##
CPPFLAGS=-I. -I$(srcdir) -I$(top_builddir)/src -I$(top_srcdir)/src  \
         -I$(top_srcdir)/tools/lib @CPPFLAGS@

## Test programs and scripts.
##
TEST_PROGS=
TEST_SCRIPTS=@TESTH4TOH5@

## These are our main targets: library and tools.
##
LIBTOOLS=../lib/libh5tools.la
LIBHDF5=$(top_builddir)/src/libhdf5.la

PUB_PROGS=@H4TOH5@
PROGS=$(PUB_PROGS) $(TEST_PROGS) @H4TOH5TEST@ 

## Source and object files for h4toh5 converter.
##
PROG_SRC=h4toh5main.c h4toh5vgroup.c h4toh5vdata.c h4toh5sds.c              \
         h4toh5image.c h4toh5pal.c h4toh5anno.c h4toh5util.c
PROG_OBJ=$(PROG_SRC:.c=.lo)

PRIVATE_HDR=h4toh5main.h h4toh5util.h

## Source and object files for the tests
##
TEST_SRC=h4toh5test.c
TEST_OBJ=$(TEST_SRC:.c=.lo)

## Programs have to be built before they can be tested!
##
check test _test: $(PROGS)

## How to build the programs... They all depend on the hdf5 library and
## the tools library compiled in this directory.
##
$(PROGS): $(LIBTOOLS) $(LIBHDF5)

h4toh5test: h4toh5test.lo
	@$(LT_LINK_EXE) $(CFLAGS) -o $@ h4toh5test.lo $(LIBTOOLS) $(LIBHDF5) $(LDFLAGS) $(LIBS)

h4toh5: $(PROG_OBJ)
	@$(LT_LINK_EXE) $(CFLAGS) -o $@ $(PROG_OBJ) $(LIBTOOLS) $(LIBHDF5) $(LDFLAGS) $(LIBS)

@CONCLUDE@
